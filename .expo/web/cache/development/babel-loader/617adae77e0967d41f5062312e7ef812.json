{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jshukurov\\\\Desktop\\\\Poppi Over The Edge\\\\Poppi-Over-the-Edge-master\\\\node_modules\\\\expo-camera\\\\build\\\\Camera.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nimport { UnavailabilityError } from '@unimodules/core';\nimport mapValues from 'lodash/mapValues';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport findNodeHandle from \"react-native-web/dist/exports/findNodeHandle\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport ViewPropTypes from \"react-native-web/dist/exports/ViewPropTypes\";\nimport ExponentCamera from \"./ExponentCamera\";\nimport _CameraManager from \"./ExponentCameraManager\";\nvar CameraManager = _CameraManager;\nvar EventThrottleMs = 500;\nvar _PICTURE_SAVED_CALLBACKS = {};\nvar _GLOBAL_PICTURE_ID = 1;\n\nfunction ensurePictureOptions(options) {\n  var pictureOptions = options || {};\n\n  if (!pictureOptions || typeof pictureOptions !== 'object') {\n    pictureOptions = {};\n  }\n\n  if (!pictureOptions.quality) {\n    pictureOptions.quality = 1;\n  }\n\n  if (pictureOptions.onPictureSaved) {\n    var id = _GLOBAL_PICTURE_ID++;\n    _PICTURE_SAVED_CALLBACKS[id] = pictureOptions.onPictureSaved;\n    pictureOptions.id = id;\n    pictureOptions.fastMode = true;\n  }\n\n  return pictureOptions;\n}\n\nfunction ensureRecordingOptions(options) {\n  var recordingOptions = options || {};\n\n  if (!recordingOptions || typeof recordingOptions !== 'object') {\n    recordingOptions = {};\n  } else if (typeof recordingOptions.quality === 'string') {\n    recordingOptions.quality = Camera.Constants.VideoQuality[recordingOptions.quality];\n  }\n\n  return recordingOptions;\n}\n\nfunction ensureNativeProps(options) {\n  var props = options || {};\n\n  if (!props || typeof props !== 'object') {\n    props = {};\n  }\n\n  var newProps = mapValues(props, convertProp);\n  var propsKeys = Object.keys(newProps);\n\n  if (!propsKeys.includes('barCodeScannerSettings') && propsKeys.includes('barCodeTypes')) {\n    console.warn(\"The \\\"barCodeTypes\\\" prop for Camera is deprecated and will be removed in SDK 34. Use \\\"barCodeScannerSettings\\\" instead.\");\n    newProps.barCodeScannerSettings = {\n      barCodeTypes: newProps.barCodeTypes\n    };\n  }\n\n  if (props.onBarCodeScanned) {\n    newProps.barCodeScannerEnabled = true;\n  }\n\n  if (props.onFacesDetected) {\n    newProps.faceDetectorEnabled = true;\n  }\n\n  if (Platform.OS !== 'android') {\n    delete newProps.ratio;\n    delete newProps.useCamera2Api;\n  }\n\n  return newProps;\n}\n\nfunction convertProp(value, key) {\n  if (typeof value === 'string' && Camera.ConversionTables[key]) {\n    return Camera.ConversionTables[key][value];\n  }\n\n  return value;\n}\n\nfunction _onPictureSaved(_ref) {\n  var {\n    nativeEvent\n  } = _ref;\n  var {\n    id,\n    data\n  } = nativeEvent;\n  var callback = _PICTURE_SAVED_CALLBACKS[id];\n\n  if (callback) {\n    callback(data);\n    delete _PICTURE_SAVED_CALLBACKS[id];\n  }\n}\n\nexport default class Camera extends React.Component {\n  constructor() {\n    super(...arguments);\n    this._lastEvents = {};\n    this._lastEventsTimes = {};\n\n    this._onCameraReady = () => {\n      if (this.props.onCameraReady) {\n        this.props.onCameraReady();\n      }\n    };\n\n    this._onMountError = (_ref2) => {\n      var {\n        nativeEvent\n      } = _ref2;\n\n      if (this.props.onMountError) {\n        this.props.onMountError(nativeEvent);\n      }\n    };\n\n    this._onObjectDetected = callback => (_ref3) => {\n      var {\n        nativeEvent\n      } = _ref3;\n      var {\n        type\n      } = nativeEvent;\n\n      if (this._lastEvents[type] && this._lastEventsTimes[type] && JSON.stringify(nativeEvent) === this._lastEvents[type] && new Date().getTime() - this._lastEventsTimes[type].getTime() < EventThrottleMs) {\n        return;\n      }\n\n      if (callback) {\n        callback(nativeEvent);\n        this._lastEventsTimes[type] = new Date();\n        this._lastEvents[type] = JSON.stringify(nativeEvent);\n      }\n    };\n\n    this._setReference = ref => {\n      if (ref) {\n        this._cameraRef = ref;\n\n        if (Platform.OS === 'web') {\n          this._cameraHandle = ref;\n        } else {\n          this._cameraHandle = findNodeHandle(ref);\n        }\n      } else {\n        this._cameraRef = null;\n        this._cameraHandle = null;\n      }\n    };\n  }\n\n  takePictureAsync(options) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      var pictureOptions = ensurePictureOptions(options);\n      return yield CameraManager.takePicture(pictureOptions, _this._cameraHandle);\n    })();\n  }\n\n  getSupportedRatiosAsync() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      if (!CameraManager.getSupportedRatios) {\n        throw new UnavailabilityError('Camera', 'getSupportedRatiosAsync');\n      }\n\n      return yield CameraManager.getSupportedRatios(_this2._cameraHandle);\n    })();\n  }\n\n  getAvailablePictureSizesAsync(ratio) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      if (!CameraManager.getAvailablePictureSizes) {\n        throw new UnavailabilityError('Camera', 'getAvailablePictureSizesAsync');\n      }\n\n      return yield CameraManager.getAvailablePictureSizes(ratio, _this3._cameraHandle);\n    })();\n  }\n\n  recordAsync(options) {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      if (!CameraManager.record) {\n        throw new UnavailabilityError('Camera', 'recordAsync');\n      }\n\n      var recordingOptions = ensureRecordingOptions(options);\n      return yield CameraManager.record(recordingOptions, _this4._cameraHandle);\n    })();\n  }\n\n  stopRecording() {\n    if (!CameraManager.stopRecording) {\n      throw new UnavailabilityError('Camera', 'stopRecording');\n    }\n\n    CameraManager.stopRecording(this._cameraHandle);\n  }\n\n  pausePreview() {\n    if (!CameraManager.pausePreview) {\n      throw new UnavailabilityError('Camera', 'pausePreview');\n    }\n\n    CameraManager.pausePreview(this._cameraHandle);\n  }\n\n  resumePreview() {\n    if (!CameraManager.resumePreview) {\n      throw new UnavailabilityError('Camera', 'resumePreview');\n    }\n\n    CameraManager.resumePreview(this._cameraHandle);\n  }\n\n  render() {\n    var nativeProps = ensureNativeProps(this.props);\n\n    var onBarCodeScanned = this._onObjectDetected(this.props.onBarCodeScanned);\n\n    var onFacesDetected = this._onObjectDetected(this.props.onFacesDetected);\n\n    return React.createElement(ExponentCamera, _extends({}, nativeProps, {\n      ref: this._setReference,\n      onCameraReady: this._onCameraReady,\n      onMountError: this._onMountError,\n      onBarCodeScanned: onBarCodeScanned,\n      onFacesDetected: onFacesDetected,\n      onPictureSaved: _onPictureSaved,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}\nCamera.Constants = {\n  Type: CameraManager.Type,\n  FlashMode: CameraManager.FlashMode,\n  AutoFocus: CameraManager.AutoFocus,\n  WhiteBalance: CameraManager.WhiteBalance,\n  VideoQuality: CameraManager.VideoQuality,\n  VideoStabilization: CameraManager.VideoStabilization || {}\n};\nCamera.ConversionTables = {\n  type: CameraManager.Type,\n  flashMode: CameraManager.FlashMode,\n  autoFocus: CameraManager.AutoFocus,\n  whiteBalance: CameraManager.WhiteBalance\n};\nCamera.propTypes = _objectSpread({}, ViewPropTypes, {\n  zoom: PropTypes.number,\n  ratio: PropTypes.string,\n  focusDepth: PropTypes.number,\n  onMountError: PropTypes.func,\n  pictureSize: PropTypes.string,\n  onCameraReady: PropTypes.func,\n  useCamera2Api: PropTypes.bool,\n  onBarCodeScanned: PropTypes.func,\n  barCodeScannerSettings: PropTypes.object,\n  onFacesDetected: PropTypes.func,\n  faceDetectorSettings: PropTypes.object,\n  type: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  flashMode: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  videoStabilizationMode: PropTypes.number,\n  whiteBalance: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  autoFocus: PropTypes.oneOfType([PropTypes.string, PropTypes.number, PropTypes.bool])\n});\nCamera.defaultProps = {\n  zoom: 0,\n  ratio: '4:3',\n  focusDepth: 0,\n  faceDetectorSettings: {},\n  type: CameraManager.Type.back,\n  autoFocus: CameraManager.AutoFocus.on,\n  flashMode: CameraManager.FlashMode.off,\n  whiteBalance: CameraManager.WhiteBalance.auto\n};\nexport var Constants = Camera.Constants;","map":{"version":3,"sources":["../src/Camera.tsx"],"names":[],"mappings":"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","sourcesContent":["import { UnavailabilityError } from '@unimodules/core';\nimport mapValues from 'lodash/mapValues';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { findNodeHandle, Platform, ViewPropTypes } from 'react-native';\nimport {\n  CapturedPicture,\n  NativeProps,\n  PictureOptions,\n  Props,\n  RecordingOptions,\n} from './Camera.types';\nimport ExponentCamera from './ExponentCamera';\nimport _CameraManager from './ExponentCameraManager';\n\n// TODO: Bacon: Fix multiplatform\nconst CameraManager = _CameraManager as any;\n\nconst EventThrottleMs = 500;\n\nconst _PICTURE_SAVED_CALLBACKS = {};\n\nlet _GLOBAL_PICTURE_ID = 1;\n\nfunction ensurePictureOptions(options?: PictureOptions): PictureOptions {\n  let pictureOptions = options || {};\n\n  if (!pictureOptions || typeof pictureOptions !== 'object') {\n    pictureOptions = {};\n  }\n\n  if (!pictureOptions.quality) {\n    pictureOptions.quality = 1;\n  }\n  if (pictureOptions.onPictureSaved) {\n    const id = _GLOBAL_PICTURE_ID++;\n    _PICTURE_SAVED_CALLBACKS[id] = pictureOptions.onPictureSaved;\n    pictureOptions.id = id;\n    pictureOptions.fastMode = true;\n  }\n  return pictureOptions;\n}\n\nfunction ensureRecordingOptions(options?: RecordingOptions): RecordingOptions {\n  let recordingOptions = options || {};\n\n  if (!recordingOptions || typeof recordingOptions !== 'object') {\n    recordingOptions = {};\n  } else if (typeof recordingOptions.quality === 'string') {\n    recordingOptions.quality = Camera.Constants.VideoQuality[recordingOptions.quality];\n  }\n\n  return recordingOptions;\n}\n\nfunction ensureNativeProps(options?: Props): NativeProps {\n  let props = options || {};\n\n  if (!props || typeof props !== 'object') {\n    props = {};\n  }\n\n  const newProps: NativeProps = mapValues(props, convertProp);\n\n  const propsKeys = Object.keys(newProps);\n  // barCodeTypes is deprecated\n  if (!propsKeys.includes('barCodeScannerSettings') && propsKeys.includes('barCodeTypes')) {\n    console.warn(\n      `The \"barCodeTypes\" prop for Camera is deprecated and will be removed in SDK 34. Use \"barCodeScannerSettings\" instead.`\n    );\n    newProps.barCodeScannerSettings = {\n      // @ts-ignore\n      barCodeTypes: newProps.barCodeTypes,\n    };\n  }\n\n  if (props.onBarCodeScanned) {\n    newProps.barCodeScannerEnabled = true;\n  }\n\n  if (props.onFacesDetected) {\n    newProps.faceDetectorEnabled = true;\n  }\n\n  if (Platform.OS !== 'android') {\n    delete newProps.ratio;\n    delete newProps.useCamera2Api;\n  }\n\n  return newProps;\n}\n\nfunction convertProp(value: any, key: string): any {\n  if (typeof value === 'string' && Camera.ConversionTables[key]) {\n    return Camera.ConversionTables[key][value];\n  }\n\n  return value;\n}\n\nfunction _onPictureSaved({ nativeEvent }: { nativeEvent: { data: CapturedPicture; id: number } }) {\n  const { id, data } = nativeEvent;\n  const callback = _PICTURE_SAVED_CALLBACKS[id];\n  if (callback) {\n    callback(data);\n    delete _PICTURE_SAVED_CALLBACKS[id];\n  }\n}\n\nexport default class Camera extends React.Component<Props> {\n  static Constants = {\n    Type: CameraManager.Type,\n    FlashMode: CameraManager.FlashMode,\n    AutoFocus: CameraManager.AutoFocus,\n    WhiteBalance: CameraManager.WhiteBalance,\n    VideoQuality: CameraManager.VideoQuality,\n    VideoStabilization: CameraManager.VideoStabilization || {},\n  };\n\n  // Values under keys from this object will be transformed to native options\n  static ConversionTables = {\n    type: CameraManager.Type,\n    flashMode: CameraManager.FlashMode,\n    autoFocus: CameraManager.AutoFocus,\n    whiteBalance: CameraManager.WhiteBalance,\n  };\n\n  static propTypes = {\n    ...ViewPropTypes,\n    zoom: PropTypes.number,\n    ratio: PropTypes.string,\n    focusDepth: PropTypes.number,\n    onMountError: PropTypes.func,\n    pictureSize: PropTypes.string,\n    onCameraReady: PropTypes.func,\n    useCamera2Api: PropTypes.bool,\n    onBarCodeScanned: PropTypes.func,\n    barCodeScannerSettings: PropTypes.object,\n    onFacesDetected: PropTypes.func,\n    faceDetectorSettings: PropTypes.object,\n    type: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    flashMode: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    videoStabilizationMode: PropTypes.number,\n    whiteBalance: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    autoFocus: PropTypes.oneOfType([PropTypes.string, PropTypes.number, PropTypes.bool]),\n  };\n\n  static defaultProps: Props = {\n    zoom: 0,\n    ratio: '4:3',\n    focusDepth: 0,\n    faceDetectorSettings: {},\n    type: CameraManager.Type.back,\n    autoFocus: CameraManager.AutoFocus.on,\n    flashMode: CameraManager.FlashMode.off,\n    whiteBalance: CameraManager.WhiteBalance.auto,\n  };\n\n  _cameraHandle?: number | null;\n  _cameraRef?: React.Component | null;\n  _lastEvents: { [eventName: string]: string } = {};\n  _lastEventsTimes: { [eventName: string]: Date } = {};\n\n  async takePictureAsync(options?: PictureOptions): Promise<CapturedPicture> {\n    const pictureOptions = ensurePictureOptions(options);\n\n    return await CameraManager.takePicture(pictureOptions, this._cameraHandle);\n  }\n\n  async getSupportedRatiosAsync(): Promise<Array<string>> {\n    if (!CameraManager.getSupportedRatios) {\n      throw new UnavailabilityError('Camera', 'getSupportedRatiosAsync');\n    }\n\n    return await CameraManager.getSupportedRatios(this._cameraHandle);\n  }\n\n  async getAvailablePictureSizesAsync(ratio?: string): Promise<Array<string>> {\n    if (!CameraManager.getAvailablePictureSizes) {\n      throw new UnavailabilityError('Camera', 'getAvailablePictureSizesAsync');\n    }\n    return await CameraManager.getAvailablePictureSizes(ratio, this._cameraHandle);\n  }\n\n  async recordAsync(options?: RecordingOptions): Promise<{ uri: string }> {\n    if (!CameraManager.record) {\n      throw new UnavailabilityError('Camera', 'recordAsync');\n    }\n\n    const recordingOptions = ensureRecordingOptions(options);\n\n    return await CameraManager.record(recordingOptions, this._cameraHandle);\n  }\n\n  stopRecording() {\n    if (!CameraManager.stopRecording) {\n      throw new UnavailabilityError('Camera', 'stopRecording');\n    }\n\n    CameraManager.stopRecording(this._cameraHandle);\n  }\n\n  pausePreview() {\n    if (!CameraManager.pausePreview) {\n      throw new UnavailabilityError('Camera', 'pausePreview');\n    }\n\n    CameraManager.pausePreview(this._cameraHandle);\n  }\n\n  resumePreview() {\n    if (!CameraManager.resumePreview) {\n      throw new UnavailabilityError('Camera', 'resumePreview');\n    }\n\n    CameraManager.resumePreview(this._cameraHandle);\n  }\n\n  _onCameraReady = () => {\n    if (this.props.onCameraReady) {\n      this.props.onCameraReady();\n    }\n  };\n\n  _onMountError = ({ nativeEvent }: { nativeEvent: { message: string } }) => {\n    if (this.props.onMountError) {\n      this.props.onMountError(nativeEvent);\n    }\n  };\n\n  _onObjectDetected = (callback?: Function) => ({ nativeEvent }: { nativeEvent: any }) => {\n    const { type } = nativeEvent;\n    if (\n      this._lastEvents[type] &&\n      this._lastEventsTimes[type] &&\n      JSON.stringify(nativeEvent) === this._lastEvents[type] &&\n      new Date().getTime() - this._lastEventsTimes[type].getTime() < EventThrottleMs\n    ) {\n      return;\n    }\n\n    if (callback) {\n      callback(nativeEvent);\n      this._lastEventsTimes[type] = new Date();\n      this._lastEvents[type] = JSON.stringify(nativeEvent);\n    }\n  };\n\n  _setReference = (ref?: React.Component) => {\n    if (ref) {\n      this._cameraRef = ref;\n      // TODO: Bacon: Make this one...\n      if (Platform.OS === 'web') {\n        this._cameraHandle = ref as any;\n      } else {\n        this._cameraHandle = findNodeHandle(ref);\n      }\n    } else {\n      this._cameraRef = null;\n      this._cameraHandle = null;\n    }\n  };\n\n  render() {\n    const nativeProps = ensureNativeProps(this.props);\n\n    const onBarCodeScanned = this._onObjectDetected(this.props.onBarCodeScanned);\n    const onFacesDetected = this._onObjectDetected(this.props.onFacesDetected);\n\n    return (\n      <ExponentCamera\n        {...nativeProps}\n        ref={this._setReference}\n        onCameraReady={this._onCameraReady}\n        onMountError={this._onMountError}\n        onBarCodeScanned={onBarCodeScanned}\n        onFacesDetected={onFacesDetected}\n        onPictureSaved={_onPictureSaved}\n      />\n    );\n  }\n}\n\nexport const Constants = Camera.Constants;\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}