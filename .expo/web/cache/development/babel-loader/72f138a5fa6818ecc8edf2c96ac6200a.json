{"ast":null,"code":"import compareVersions from 'compare-versions';\nimport CodedError from \"./CodedError\";\nvar postedWarnings = {};\nexport default function deprecate(library, deprecatedAPI) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var {\n    currentVersion,\n    versionToRemove,\n    replacement\n  } = options;\n  var code = codeFromLibrary(library);\n  var key = \"\".concat(code, \":\").concat(deprecatedAPI, \":\").concat(replacement);\n\n  if (!postedWarnings[key]) {\n    postedWarnings[key] = true;\n  }\n\n  if (!currentVersion || !versionToRemove || compareVersions(currentVersion, versionToRemove) >= 0) {\n    var _message = \"`\".concat(deprecatedAPI, \"` has been removed\");\n\n    if (versionToRemove) {\n      _message = \"\".concat(_message, \" as of version \\\"\").concat(versionToRemove, \"\\\"\");\n    }\n\n    if (replacement && replacement.length) {\n      _message = \"\".concat(_message, \" please migrate to: `\").concat(replacement, \"`\");\n    }\n\n    throw new CodedError(\"ERR_DEPRECATED_API\", prependLibrary(library, _message));\n  }\n\n  var message = \"`\".concat(deprecatedAPI, \"` has been deprecated\");\n\n  if (replacement && replacement.length) {\n    message = \"\".concat(message, \" in favor of `\").concat(replacement, \"`\");\n  }\n\n  if (versionToRemove && versionToRemove.length) {\n    message = \"\".concat(message, \" and will be removed in version \\\"\").concat(versionToRemove, \"\\\"\");\n  }\n\n  console.warn(prependLibrary(library, message));\n}\n\nfunction prependLibrary(library, message) {\n  return \"\".concat(library, \": \").concat(message);\n}\n\nfunction codeFromLibrary(library) {\n  var code = library.replace(/[-\\.]/g, '_').toUpperCase();\n  return code;\n}","map":{"version":3,"sources":["../src/deprecate.ts"],"names":[],"mappings":"AAAA,OAAO,eAAP,MAA4B,kBAA5B;AACA,OAAO,UAAP;AAEA,IAAM,cAAc,GAA+B,EAAnD;AAKA,eAAc,SAAU,SAAV,CACZ,OADY,EAEZ,aAFY,EAON;AAAA,MAJN,OAIM,uEAAF,EAAE;AAEN,MAAM;AAAE,IAAA,cAAF;AAAkB,IAAA,eAAlB;AAAmC,IAAA;AAAnC,MAAmD,OAAzD;AACA,MAAM,IAAI,GAAG,eAAe,CAAC,OAAD,CAA5B;AACA,MAAM,GAAG,aAAM,IAAN,cAAc,aAAd,cAA+B,WAA/B,CAAT;;AACA,MAAI,CAAC,cAAc,CAAC,GAAD,CAAnB,EAA0B;AACxB,IAAA,cAAc,CAAC,GAAD,CAAd,GAAsB,IAAtB;AACD;;AAED,MACE,CAAC,cAAD,IACA,CAAC,eADD,IAEA,eAAe,CAAC,cAAD,EAAiB,eAAjB,CAAf,IAAoD,CAHtD,EAIE;AACA,QAAI,QAAO,cAAQ,aAAR,uBAAX;;AACA,QAAI,eAAJ,EAAqB;AACnB,MAAA,QAAO,aAAM,QAAN,8BAAgC,eAAhC,OAAP;AACD;;AACD,QAAI,WAAW,IAAI,WAAW,CAAC,MAA/B,EAAuC;AACrC,MAAA,QAAO,aAAM,QAAN,kCAAsC,WAAtC,MAAP;AACD;;AAED,UAAM,IAAI,UAAJ,uBAAqC,cAAc,CAAC,OAAD,EAAU,QAAV,CAAnD,CAAN;AACD;;AAED,MAAI,OAAO,cAAQ,aAAR,0BAAX;;AACA,MAAI,WAAW,IAAI,WAAW,CAAC,MAA/B,EAAuC;AACrC,IAAA,OAAO,aAAM,OAAN,2BAA+B,WAA/B,MAAP;AACD;;AACD,MAAI,eAAe,IAAI,eAAe,CAAC,MAAvC,EAA+C;AAC7C,IAAA,OAAO,aAAM,OAAN,+CAAiD,eAAjD,OAAP;AACD;;AACD,EAAA,OAAO,CAAC,IAAR,CAAa,cAAc,CAAC,OAAD,EAAU,OAAV,CAA3B;AACD;;AAED,SAAS,cAAT,CAAwB,OAAxB,EAAyC,OAAzC,EAAwD;AACtD,mBAAU,OAAV,eAAsB,OAAtB;AACD;;AAOD,SAAS,eAAT,CAAyB,OAAzB,EAAwC;AACtC,MAAM,IAAI,GAAG,OAAO,CAAC,OAAR,CAAgB,QAAhB,EAA0B,GAA1B,EAA+B,WAA/B,EAAb;AACA,SAAO,IAAP;AACD","sourcesContent":["import compareVersions from 'compare-versions';\nimport CodedError from './CodedError';\n\nconst postedWarnings: { [key: string]: boolean } = {};\n\n/**\n * Used for deprecating values and throwing an error if a given version of Expo has passed.\n */\nexport default function deprecate(\n  library: string,\n  deprecatedAPI: string,\n  options: {\n    replacement?: string;\n    currentVersion?: string;\n    versionToRemove?: string;\n  } = {}\n): void {\n  const { currentVersion, versionToRemove, replacement } = options;\n  const code = codeFromLibrary(library);\n  const key = `${code}:${deprecatedAPI}:${replacement}`;\n  if (!postedWarnings[key]) {\n    postedWarnings[key] = true;\n  }\n\n  if (\n    !currentVersion ||\n    !versionToRemove ||\n    compareVersions(currentVersion, versionToRemove) >= 0\n  ) {\n    let message = `\\`${deprecatedAPI}\\` has been removed`;\n    if (versionToRemove) {\n      message = `${message} as of version \"${versionToRemove}\"`;\n    }\n    if (replacement && replacement.length) {\n      message = `${message} please migrate to: \\`${replacement}\\``;\n    }\n\n    throw new CodedError(`ERR_DEPRECATED_API`, prependLibrary(library, message));\n  }\n\n  let message = `\\`${deprecatedAPI}\\` has been deprecated`;\n  if (replacement && replacement.length) {\n    message = `${message} in favor of \\`${replacement}\\``;\n  }\n  if (versionToRemove && versionToRemove.length) {\n    message = `${message} and will be removed in version \"${versionToRemove}\"`;\n  }\n  console.warn(prependLibrary(library, message));\n}\n\nfunction prependLibrary(library: string, message: string): string {\n  return `${library}: ${message}`;\n}\n\n/**\n * Transform format:\n * Expo.AR -> EXPO_AR\n * expo-ar -> EXPO_AR\n */\nfunction codeFromLibrary(library: string): string {\n  const code = library.replace(/[-\\.]/g, '_').toUpperCase();\n  return code;\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}